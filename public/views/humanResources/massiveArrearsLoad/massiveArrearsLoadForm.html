<div ng-controller="MassiveArrearsLoadCtrl">
    <form action="" method="post" enctype="multipart/form-data">
        <fieldset>
            <div class="hr-line-dashed"></div>
            <div class="row">
                <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                    <div class="form-group" >
                        <label class="control-label"><u>M</u>es</label>
                        <div class="input-group input-group-sm">
                            <select class="form-control" placeholder="" ng-model="mes" ng-required="true" id="mes" name="mes"
                                    ng-change="searchMes()" tabindex="21">
                                <option value=""></option>
                                <option value="January">Enero</option>
                                <option value="February">Febrero</option>
                                <option value="March">Marzo</option>
                                <option value="April">Abril</option>
                                <option value="May">Mayo</option>
                                <option value="June">Junio</option>
                                <option value="July">Julio</option>
                                <option value="August">Agosto</option>
                                <option value="September">Septiembre</option>
                                <option value="October">Octubre</option>
                                <option value="November">Noviembre</option>
                                <option value="December">Diciembre</option>
                            </select>
                            <span class="input-group-addon"><i class="fa fa-building"></i></span>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="row">
                        <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12" >
                            <button class="btn btn-primary" type="botton" ng-click="openFile()" ng-controller="MassiveArrearsLoadCtrl">Subir</button>
                        </div>
                    </div>
        </fieldset>
        <div class='form-group'>
            <input type="file" name="excel_file" accept=".xlsx" onchange="angular.element(this).scope().fileChanged(this.files);" required="true">
        </div>

        <div class="checkbox">
            <label>
                <input type="checkbox" ng-model="showPreview" ng-change="showPreviewChanged();">Show preview of excel file
            </label>
        </div>
        <div class="checkbox">
            <label>
                <input type="checkbox" ng-model="showJSONPreview">Show JSON preview of selected sheet
            </label>
        </div>
        <div ng-show="isProcessing">
            <span>Processing ...</span>
        </div>

        <div class='form-group'>
            <label for='sheet_name'>Sheet Name</label>
            <select id="sheet_name" class="form-control" ng-change="updateJSONString()" ng-model="selectedSheetName" required="true" ng-required="true" ng-options="sheetName as sheetName for (sheetName, sheetData) in sheets">
                <option value="">---- Select a sheet ----</option>
            </select>
        </div>

        <input type="hidden" name="sheet_name" value="{{ selectedSheetName }}">

        <input type="submit" value="Submit">

        <div ng-show="showJSONPreview">
            <h4>JSON Preview of selected sheet</h4>
                    <pre>
                        <code>{{ json_string }}</code>
                    </pre>
        </div>
        <div ng-show="showPreview">
            <table class="table table-bordered" ng-repeat="(sheetName, sheetData) in sheets track by $index" ng-show="sheetName == selectedSheetName">
                <thead>
                <tr>
                    <th ng-bind="sheetName"></th>
                </tr>
                </thead>
                <tr ng-repeat="row in sheetData.data track by $index">
                    <td ng-repeat="col in row track by $index" ng-bind="col"></td>
                </tr>
            </table>
        </div>
    </form>
</div>
